<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>ELK on 堂吉哈哈德的博客</title>
    <link>https://xinxiaoyu.github.io/categories/ELK/</link>
    <description>Recent content in ELK on 堂吉哈哈德的博客</description>
    <generator>Hugo</generator>
    <language>zh-CN</language>
    <lastBuildDate>Fri, 16 Oct 2020 13:47:34 +0800</lastBuildDate>
    <atom:link href="https://xinxiaoyu.github.io/categories/ELK/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Logstash处理Nginx日志</title>
      <link>https://xinxiaoyu.github.io/post/ELK/logstash%E5%A4%84%E7%90%86Nginx%E6%97%A5%E5%BF%97/</link>
      <pubDate>Fri, 16 Oct 2020 13:47:34 +0800</pubDate>
      <guid>https://xinxiaoyu.github.io/post/ELK/logstash%E5%A4%84%E7%90%86Nginx%E6%97%A5%E5%BF%97/</guid>
      <description>&lt;p&gt;nginx log_format&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&#xA;&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&#xA;&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2&#xA;&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3&#xA;&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4&#xA;&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5&#xA;&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-nginx&#34; data-lang=&#34;nginx&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#cf222e&#34;&gt;log_format&lt;/span&gt;  &lt;span style=&#34;color:#0a3069&#34;&gt;ops&lt;/span&gt; &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#953800&#34;&gt;$remote_addr&lt;/span&gt; &lt;span style=&#34;color:#0a3069&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#953800&#34;&gt;$remote_user&lt;/span&gt; &lt;span style=&#34;color:#0a3069&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#953800&#34;&gt;$time_local]&lt;/span&gt; &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#953800&#34;&gt;$request&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#953800&#34;&gt;$status&lt;/span&gt; &lt;span style=&#34;color:#953800&#34;&gt;$body_bytes_sent&lt;/span&gt; &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#953800&#34;&gt;$http_referer&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#39;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#953800&#34;&gt;$http_user_agent&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#953800&#34;&gt;$http_x_forwarded_for&lt;/span&gt; &lt;span style=&#34;color:#953800&#34;&gt;$request_time&lt;/span&gt; &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#953800&#34;&gt;$upstream_addr&lt;/span&gt; &lt;span style=&#34;color:#953800&#34;&gt;$upstream_response_time&lt;/span&gt; &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#39;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#953800&#34;&gt;$content_type&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#0a3069&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#953800&#34;&gt;$host&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#1f2328&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;日志用例&lt;/p&gt;</description>
    </item>
    <item>
      <title>Elasticsearch迁移工具</title>
      <link>https://xinxiaoyu.github.io/post/ELK/es%E8%BF%81%E7%A7%BB%E5%B7%A5%E5%85%B7/</link>
      <pubDate>Tue, 26 Feb 2019 16:42:02 +0800</pubDate>
      <guid>https://xinxiaoyu.github.io/post/ELK/es%E8%BF%81%E7%A7%BB%E5%B7%A5%E5%85%B7/</guid>
      <description>&lt;p&gt;迁移工具地址：&#xA;&lt;a href=&#34;https://github.com/medcl/esm&#34;&gt;https://github.com/medcl/esm&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;迁移脚本&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#!/bin/bash&#xD;&#xA;&#xD;&#xA;filter_time=`date +%Y-%m-%d -d &amp;#34;-8 days&amp;#34;`&#xD;&#xA;index_arr=(es_collect es_keyword es_app)&#xD;&#xA;prod_es=&amp;#34;http://:9200&amp;#34;&#xD;&#xA;pre_es=&amp;#34;http://:19200&amp;#34;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;for i in ${index_arr[@]}&#xD;&#xA;  do&#xD;&#xA;  echo &amp;#34;$i start rync.&amp;#34; &amp;gt;&amp;gt; ./es_rync.log&#xD;&#xA;  echo &amp;#34;`date`&amp;#34; &amp;gt;&amp;gt; ./es_rync.log&#xD;&#xA;  ./migrator-linux-amd64 -s ${prod_es} -d ${pre_es} -x $i -q=cycle_time:${filter_time} -y $i -w=1 -b=1&#xD;&#xA;  echo &amp;#34;`date` done.&amp;#34; &amp;gt;&amp;gt; ./es_rync.log&#xD;&#xA;  echo &amp;#34;done&amp;#34;&#xD;&#xA;  #exit 100&#xD;&#xA;done&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>Elasticsearch集群配置</title>
      <link>https://xinxiaoyu.github.io/post/ELK/es_cluster/</link>
      <pubDate>Mon, 25 Feb 2019 16:42:02 +0800</pubDate>
      <guid>https://xinxiaoyu.github.io/post/ELK/es_cluster/</guid>
      <description>&lt;p&gt;设置hosts&lt;/p&gt;&#xA;&lt;p&gt;es-node-1  192.168.41.74&lt;/p&gt;&#xA;&lt;p&gt;es-node-2  192.168.41.53&lt;/p&gt;&#xA;&lt;p&gt;es-node-3  192.168.41.73&lt;/p&gt;&#xA;&lt;p&gt;es-node-1的elastisearch.yml文件如下:&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
